<!DOCTYPE html>
{% extends "foundation/base.html" %}
</head>
<html>
{% block base_body %}
{%include "navBar/bar.html" %}
{% load staticfiles %}
<link rel="stylesheet" type="text/css" href="{% static "style/style.css" %}" />
<br>
<div>
{{request.session.testParam}}
<form id="assigForm" action={{action}}>{% csrf_token %}
	<div class="row center">
			<div class="row collapse" id="imgDiv" align="center">
				<br><br><br><br>
				<script src="{% static "js/decider.js" %}"></script>
				<script src="{% static "js/draw.js" %}"></script>
				<label class="small-9 collumns" id="label" for="input">
					<script>
						deciderType("{{type}}","{{question}}");
					</script>
				</label>
				<div id="canvasDiv">
				<canvas id="myCanvas" width="250" height="150"></canvas>
				</div>
				<script>draw("{{type}}","{{question}}","{{p1}}","{{p2}}")</script>
				<br>
				<div class="large-3 collumns" id="userPart">
						<input id="input" type="number" name="ans" placeholder="write an answer here" step="0.01" required/>
						<div id="assigment"></div><br>
				</div>
				<div class="large-6 rows" id="answer" ></div>
			</div>
			<div class="progress" id="testCounter"></div>
			<div id="timeCounter" align="center"></div>
            <div id = "next">
				<input id="sub" type="submit" class="button" value="Odpovedat" />
			</div>
			<p id="timer" align="left"></p>
	</div>


{% if request.session.testParam == -1%}
	<script>
		var testParam = (new Date()).getTime();
	</script>
{% else %}
	<script>
		var testParam = "{{request.session.testParam}}";
		testParam = parseInt(testParm) +1000;
	</script>
{% endif %}
<script>
$(document).ready(function(){
	handleNextQuestion("{{type}}","{{test}}",testParam);
});
			


	function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
	}

	var csrftoken = getCookie('csrftoken');
	$('#assigForm').on('submit', function(event){
		clearInterval(interval);
 		clearInterval(t);
		var doc = document.getElementById("assigForm");
    	event.preventDefault();

    	create_post(JSON.stringify({
			p1:"{{p1}}",
			p2:"{{p2}}",
			question:"{{question}}",
			testP:testParam,
			used_hint:used_hint,
		}),"{{type}}");
	});

	var used_hint=0;	
	if ("{{type}}" == "temp"){
		function useHint(){
			tempHint("{{p1}}","{{p2}}");
		}
	} else {

	    function useHint(){
	        hint(JSON.stringify({
			type:"{{type}}",
			p1:"{{p1}}",
			p2:"{{p2}}"}));
		};
	}
</script>

{% endblock base_body %}
</html>
 
